---
title: "Github Collaboration"
author: Tingwei Adeck, Kaity Trinidad, Noor Aayla
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
  pdf_document:
    latex_engine: xelatex
  html_document:
    df_print: paged
  html_notebook: default
  word_document: default
header-includes:
  - \usepackage{geometry} 
  - \geometry{top=0.5in}
  - \usepackage{float}
  - \usepackage{titlesec}
  - \usepackage{amsmath}
  - \usepackage{amssymb}
---

```{r echo=FALSE, warning=FALSE, message=FALSE}
#housework
library(utils)
library(pastecs)
library(readxl)
#tidyverse
library(dplyr)
library(tidyr)
library(broom)
library(janitor)
#plotting
library(rlang)
library(ggplot2)
library(RColorBrewer)
library(ggnormfluodbf)
#stats
library(stats) #shapiro
library(dgof) #kolmogorov
library(car) #levene's
#markdown
library(knitr)
library(kableExtra)
```

# Import Data

```{r import txtmsg data, warning=FALSE, message=FALSE}
library(readr)
TextMessages <- read_csv("TextMessages.csv") #1-use read_csv (parent df)
#View(TextMessages)
#head(TextMessages)
```

```{r preview table}
kable(head(TextMessages,5), format = "markdown", #
      caption = "Text Message Data Preview", 
      table.envir = "table", align = "c")
```

\newpage

# Factorization (Data Wrangling)

```{r check df}
str(TextMessages)
```

```{r factorize, message=FALSE, warning=FALSE}
#factor a variable en place - risky
make_factor <- function(data, var){
  refactored <- as.factor(data[[var]]) #make factor
  data[[var]] <- refactored #assign factor back to var
  data #return
}

#factor with labels scalably
#!!! to unpack the vectors and setnames to map values to labels
make_factor_scale <- function(data, var, newvarName, fact_num_vect, 
                                    fact_char_vect) {
  data[[newvarName]] <- dplyr::recode(data[[var]], 
                                      !!!setNames(fact_char_vect,
                                                  fact_num_vect)) 
  refactored <- as.factor(data[[newvarName]])
  data[[newvarName]] <- refactored
  data
}

#check the groups
unique(TextMessages$Group)
TextMessages <- make_factor_scale(TextMessages, 
                                       "Group", 
                                       "Group_factor", c(1,2), 
                                       c("Group 1", 
                                         "Group 2"))

TextMessages <- TextMessages %>%
  dplyr::relocate("Group_factor", .after = "Group")
```

\newpage

# Summary Statistics

```{r}
summary_stats_long <- TextMessages %>% 
  group_by(Group_factor) %>% 
  summarise(
    Baseline_Mean = mean(Baseline, na.rm = TRUE),
    Baseline_SD = sd(Baseline, na.rm = TRUE),
    Baseline_Min = min(Baseline, na.rm = TRUE),
    Baseline_Max = max(Baseline, na.rm = TRUE),
    SixMonths_Mean = mean(Six_months, na.rm = TRUE),
    SixMonths_SD = sd(Six_months, na.rm = TRUE),
    SixMonths_Min = min(Six_months, na.rm = TRUE),
    SixMonths_Max = max(Six_months, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = -Group_factor,
    names_to = c("Timepoint", "Statistic"),
    names_sep = "_"
  )
```

```{r echo = FALSE}
kable(summary_stats_long, format = "markdown", 
      caption = "Statistical Summary for Baseline and Six Months", 
      table.envir = "table", align = "c")
```

```{r echo = FALSE, include=FALSE}
#ideal key but using Noors
Value_bs <- stat.desc(TextMessages$Baseline)
Value_sm <- stat.desc(TextMessages$Six_months)
em_summ_df_bs <- as.data.frame(Value_bs)
em_summ_df_sm <- as.data.frame(Value_sm)
row_names_bs <- rownames(em_summ_df_bs)
row_names_sm <- rownames(em_summ_df_sm)

em_summ_df_bs <- em_summ_df_bs %>%
  tibble::rownames_to_column(var = "Statistic")

em_summ_df_sm <- em_summ_df_sm %>%
  tibble::rownames_to_column(var = "Statistic")

# Pivot to wide format
wide_data_bs <- em_summ_df_bs %>%
  pivot_wider(names_from = "Statistic", values_from = colnames(em_summ_df_bs)[2])

wide_data <- em_summ_df_sm %>%
  pivot_wider(names_from = "Statistic", values_from = colnames(em_summ_df_sm)[2])
```

```{r eval=FALSE, include=FALSE}
kable(em_summ_df_bs, format = "markdown", 
      caption = "Statistical Summary Long Table for Baseline", 
      table.envir = "table", align = "c")
```

```{r echo = FALSE, include=FALSE}
kable(em_summ_df_sm, format = "markdown", 
      caption = "Statistical Summary Long Table for Six Months", 
      table.envir = "table", align = "c")
```

\newpage

# Breakdown

At the Baseline (Initial Time Point), participants in Group 1 sent an average of 64.8 text messages, with a standard deviation of 10.7, indicating moderate variability in texting behavior. The minimum number of messages sent was 47, while the maximum was 85. Similarly, participants in Group 2 had a slightly higher mean of 65.6 messages, with a standard deviation of 10.8, suggesting a similar spread of values. The minimum number of messages in this group was 46, and the maximum was 89.

After six months, both groups experienced a decline in the number of messages sent. Group 1 saw a more substantial reduction, with a new mean of 53.0 messages (a decrease of approximately 11.8 messages from baseline). Additionally, the standard deviation increased to 16.3, suggesting that
individuals in this group displayed more varied texting behavior over time. The minimum and maximum values were not explicitly provided but are likely within the range of 9 to 78 messages. In contrast, Group 2 maintained a relatively higher number of messages, with a mean of 61.8 messages
(a smaller decrease of about 3.8 messages from baseline). The standard deviation was 9.41, indicating that texting behavior remained more consistent within this group. The minimum and maximum values were at least 46 and 79
messages, respectively.

# Overall Interpretation

Both groups showed a decline in the number of text messages sent over time. However, Group 1 experienced a greater decrease, suggesting that participants in this group reduced their texting behavior more substantially. Additionally,the increase in standard deviation for Group 1 at six months indicates greater variability in how much texting behavior changed within this groupâ€”some participants may have significantly reduced their texting, while others maintained a more consistent level. On the other hand, Group 2 exhibited more stable texting behavior, with a smaller overall decline and less variability over time.

\newpage

# Barplot Visualization

```{r}
#pivot kaity way
longtext <- gather(TextMessages,Time,Count,Baseline:Six_months, factor_key = TRUE )

#pivot data Tingwei way
TextMessages_long <- TextMessages %>%
  pivot_longer(cols = c(Baseline, Six_months), 
               names_to = "Timepoint", 
               values_to = "Value")
```


```{r facet bar plot, message=FALSE, warning=FALSE, fig.width=8, fig.height=6, fig.align='center'}
#ideal solution just need to add error bars
barp <- ggplot(TextMessages_long, 
               aes(x = Group_factor, 
                   y = Value, 
                   fill = Group_factor)) +
  stat_summary(fun = "mean", geom = "bar") +
  stat_summary(fun.data =  mean_cl_normal, #"mean_se" 
               geom = "errorbar", 
               width = .2,
               fun.args = list(mult = 1)) +
  facet_grid(. ~ Timepoint, scales = "free") +
  labs(x = "Group Factor", y = "Value", 
       title = "Comparison of Baseline and Six Months Values")

print(barp)
```

\newpage

# Bar plot Interpretation

<Kaity Add description and interpretation Here>

\newpage

# Boxplot Visualization

```{r facet box plot, message=FALSE, warning=FALSE, fig.width=8, fig.height=6, fig.align='center'}
#make facet
boxp <- ggplot(TextMessages_long, 
             aes(x = Group_factor, 
                 y = Value, 
                 fill = Group_factor)) +
  geom_boxplot() +
  facet_grid(. ~ Timepoint, scales = "free") +
  labs(x = "Group Factor", y = "Value", 
       title = "Comparison of Baseline and Six Months Values")

print(boxp)
```
\newpage

# Box plot Interpretation

There is an observed decrease in the median measure of central tendency which can be extrapolated to the mean and mode of the value being measured. So it means the time frame has an effect on the outcome being analyzed albeit being unable to determine statistical or practical significance. 

Secondly, the change in time frame leads to decreased normality of the data as skewness is introduced into both groups at the six month mark. The direction of skewness is not relevant in this brief analysis as this can be done when performing a deeper analysis.

Thirdly, outliers are introduced in the data at the six month mark. This likely indicates that the drivers of the outcome might be introducing some abnormal effects into the groups leading to extreme behaviors of the participants. In Group 1 most outliers deviate towards the low end meaning the effect drivers seem to trigger inhibitory tendencies within some members of this group while the second group seems to exhibit excitatory tendencies from the outcome drivers.

Generally, the longitudinal effect of the study points towards decreased normality of the data and there might be other outcome drivers that trigger extreme behaviors in some study participants.

\newpage

# Conclusion

This document provides 3 outputs as demanded. The team was able to contribute equally in the generation of this document. There is still a steep learning curve for git and github for all team members but thankfully some of us have a handle on the use of technology to get this project to its complete or mature state.

\newpage

# References

[ggplot2 facet : split a plot into a matrix of panels ](https://www.sthda.com/english/wiki/ggplot2-facet-split-a-plot-into-a-matrix-of-panels)