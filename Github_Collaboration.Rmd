---
title: "Github Collaboration"
author: Tingwei Adeck, Kaity Trinidad, Noor Aayla
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
  pdf_document:
    latex_engine: xelatex
  html_document:
    df_print: paged
  html_notebook: default
  word_document: default
header-includes:
  - \usepackage{geometry} 
  - \geometry{top=0.5in}
  - \usepackage{float}
  - \usepackage{titlesec}
  - \usepackage{amsmath}
  - \usepackage{amssymb}
---

```{r echo=FALSE, warning=FALSE, message=FALSE}
#housework
library(utils)
library(pastecs)
library(readxl)
#tidyverse
library(dplyr)
library(tidyr)
library(broom)
library(janitor)
#plotting
library(rlang)
library(ggplot2)
library(RColorBrewer)
library(ggnormfluodbf)
#stats
library(stats) #shapiro
library(dgof) #kolmogorov
library(car) #levene's
#markdown
library(knitr)
library(kableExtra)
```

# Import Data

```{r import txtmsg data, warning=FALSE, message=FALSE}
library(readr)
TextMessages <- read_csv("TextMessages.csv") #1-use read_csv (parent df)
#View(TextMessages)
#head(TextMessages)
```

```{r preview table}
kable(head(TextMessages,5), format = "markdown", #
      caption = "Text Message Data Preview", 
      table.envir = "table", align = "c")
```

\newpage

# Factorization (Data Wrangling)

```{r factorize, message=FALSE, warning=FALSE}
#factor a variable en place - risky
make_factor <- function(data, var){
  refactored <- as.factor(data[[var]]) #make factor
  data[[var]] <- refactored #assign factor back to var
  data #return
}

#factor with labels scalably
#!!! to unpack the vectors and setnames to map values to labels
make_factor_scale <- function(data, var, newvarName, fact_num_vect, 
                                    fact_char_vect) {
  data[[newvarName]] <- dplyr::recode(data[[var]], 
                                      !!!setNames(fact_char_vect,
                                                  fact_num_vect)) 
  data
}

#check the groups
unique(TextMessages$Group)
TextMessages <- make_factor_scale(TextMessages, 
                                       "Group", 
                                       "Group_factor", c(1,2), 
                                       c("Group 1", 
                                         "Group 2"))
TextMessages <- TextMessages %>% 
  dplyr::relocate("Group_factor", .after = "Group")
```

\newpage

# Summary Table Setup

```{r}
Value_bs <- stat.desc(TextMessages$Baseline)
Value_sm <- stat.desc(TextMessages$Six_months)
em_summ_df_bs <- as.data.frame(Value_bs)
em_summ_df_sm <- as.data.frame(Value_sm)
row_names_bs <- rownames(em_summ_df_bs)
row_names_sm <- rownames(em_summ_df_sm)

em_summ_df_bs <- em_summ_df_bs %>%
  tibble::rownames_to_column(var = "Statistic")

em_summ_df_sm <- em_summ_df_sm %>%
  tibble::rownames_to_column(var = "Statistic")

# Pivot to wide format
wide_data_bs <- em_summ_df_bs %>%
  pivot_wider(names_from = "Statistic", values_from = colnames(em_summ_df_bs)[2])

wide_data <- em_summ_df_sm %>%
  pivot_wider(names_from = "Statistic", values_from = colnames(em_summ_df_sm)[2])
```

```{r}
kable(em_summ_df_bs, format = "markdown", 
      caption = "Statistical Summary Long Table for Baseline", 
      table.envir = "table", align = "c")
```

\newpage

```{r}
kable(em_summ_df_sm, format = "markdown", 
      caption = "Statistical Summary Long Table for Six Months", 
      table.envir = "table", align = "c")
```

\newpage

# Breakdown

At the Baseline (Initial Time Point), participants in Group 1 sent an average of 64.8 text messages, with a standard deviation of 10.7, indicating moderate variability in texting behavior. The minimum number of messages sent was 47, while the maximum was 85. Similarly, participants in Group 2 had a slightly higher mean of 65.6 messages, with a standard deviation of 10.8, suggesting a similar spread of values. The minimum number of messages in this group was 46, and the maximum was 89.

After six months, both groups experienced a decline in the number of messages sent. Group 1 saw a more substantial reduction, with a new mean of 53.0 messages (a decrease of approximately 11.8 messages from baseline). Additionally, the standard deviation increased to 16.3, suggesting that
individuals in this group displayed more varied texting behavior over time. The minimum and maximum values were not explicitly provided but are likely within the range of 9 to 78 messages. In contrast, Group 2 maintained a relatively higher number of messages, with a mean of 61.8 messages
(a smaller decrease of about 3.8 messages from baseline). The standard deviation was 9.41, indicating that texting behavior remained more consistent within this group. The minimum and maximum values were at least 46 and 79
messages, respectively.

# Overall Interpretation

Both groups showed a decline in the number of text messages sent over time. However, Group 1 experienced a greater decrease, suggesting that participants in this group reduced their texting behavior more substantially. Additionally,the increase in standard deviation for Group 1 at six months indicates greater variability in how much texting behavior changed within this groupâ€”some participants may have significantly reduced their texting, while others maintained a more consistent level. On the other hand, Group 2 exhibited more stable texting behavior, with a smaller overall decline and less variability over time.

\newpage

# References

[ggplot2 facet : split a plot into a matrix of panels ](https://www.sthda.com/english/wiki/ggplot2-facet-split-a-plot-into-a-matrix-of-panels)