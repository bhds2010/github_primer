---
title: "Github Collaboration"
author: Tingwei Adeck, Kaity Trinidad, Noor Aayla
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
  pdf_document:
    latex_engine: xelatex
  html_document:
    df_print: paged
  html_notebook: default
  word_document: default
header-includes:
  - \usepackage{geometry} 
  - \geometry{top=0.5in}
  - \usepackage{float}
  - \usepackage{titlesec}
  - \usepackage{amsmath}
  - \usepackage{amssymb}
---

```{r echo=FALSE, warning=FALSE, message=FALSE}
#housework
library(utils)
library(pastecs)
library(readxl)
#tidyverse
library(dplyr)
library(tidyr)
library(broom)
library(janitor)
#plotting
library(rlang)
library(ggplot2)
library(RColorBrewer)
library(ggnormfluodbf)
#stats
library(stats) #shapiro
library(dgof) #kolmogorov
library(car) #levene's
#markdown
library(knitr)
library(kableExtra)
```

# Import Data

```{r import txtmsg data, warning=FALSE, message=FALSE}
library(readr)
TextMessages <- read_csv("TextMessages.csv")
#View(TextMessages)
head(TextMessages)
```

# Factorization (Data Wrangling)

```{r factorize, message=FALSE, warning=FALSE}
#factor a variable en place - risky
make_factor <- function(data, var){
  refactored <- as.factor(data[[var]]) #make factor
  data[[var]] <- refactored #assign factor back to var
  data #return
}

#factor with labels scalably
#!!! to unpack the vectors and setnames to map values to labels
make_factor_scale <- function(data, var, newvarName, fact_num_vect, 
                                    fact_char_vect) {
  data[[newvarName]] <- dplyr::recode(data[[var]], 
                                      !!!setNames(fact_char_vect,
                                                  fact_num_vect)) 
  data
}

#check the groups
unique(TextMessages$Group)
TextMessages <- make_factor_scale(TextMessages, 
                                       "Group", 
                                       "Group_factor", c(1,2), 
                                       c("Group 1", 
                                         "Group 2"))
TextMessages <- TextMessages %>% 
  dplyr::relocate("Group_factor", .after = "Group")
```


# prepare data (Kaity's way)

```{r}
#Import Data
Text <-read.csv("TextMessages.csv", header=TRUE)
longtext<-gather(Text,Time,Count,Baseline:Six_months, factor_key = TRUE )
```

# Barchart with error bars

```{r facet bar plot, message=FALSE, warning=FALSE, fig.width=8, fig.height=6, fig.align='center'}
barp <- ggplot(TextMessages_long,
               aes(x = Group_factor,
                   y = Value,
                   fill = Group_factor)) +
  stat_summary(fun = "mean", geom = "bar") +
  stat_summary(fun.data = mean_cl_normal, #"mean_se"
               geom = "errorbar",
               width = .2,
               fun.args = list(mult = 1)) +
  facet_grid(. ~ Timepoint, scales = "free") +
  labs(x = "Group Factor", y = "Value",
       title = "Comparison of Baseline and Six Months Values")
print(barp)
```

# Boxplot

```{r}
boxp <- ggplot(TextMessages_long,
               aes(x = Group_factor,
                   y = Value,
                   fill = Group_factor)) +
  geom_boxplot()+ 
  facet_grid(. ~ Timepoint, scales = "free") +
  labs(x = "Group Factor", y = "Value",
       title = "Comparison of Baseline and Six Months Values")
print(boxp)
```

#Description 
If we compare the box plots for both groups at baseline, their medians are 
roughly the same though Group2's is sightly higher by a fractional margin. As 
indicated previously, the spread of data for the second group is  much
wider at the upper end, showing that there may be some left tail skewness in 
their distribution. Looking at the error bar charts, the overlap between both 
groups shows that there is a chance of no statistical significance in the 
difference in means between both groups at baseline. If we proceed to the 
sixth month follow up, there is confirmation that in fact both groups have a 
decline in text messaging, more so for group 1 than group 2. Group 1 has a 
much higher degree of outliers and flatness on the left tail. This shows that
much of the variability in decreased textmessaging for group 1 may be attributed  
to a smaller quantity of people. This could also possibly indicate some degree
of intervention effect in the the second group at followup since both groups 
were fairly similar at baseline. If we look at the error bars in the histogram,
it is clear that there could be some statistical significance in the difference
in means between both groups at the six month follow up. 

